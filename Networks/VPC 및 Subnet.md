[[Networks]]
# 네이버 클라우드 플랫폼(NCP) VPC 및 서브넷 가이드

## VPC 개요

VPC(Virtual Private Cloud)는 사용자 전용 가상 네트워크 환경으로, 클라우드 내에서 논리적으로 격리된 네트워크 공간을 제공합니다.

## 서브넷 구성

### 서브넷 개념

- 서브넷은 VPC 내부의 더 작은 네트워크 단위입니다.
- 서브넷은 CIDR 표기법(예: /24, /27)으로 크기를 정의합니다.
- VPC의 전체 주소 공간을 여러 서브넷으로 분할할 수 있습니다.

### 서브넷 크기 예시

- **/24 서브넷**: 256개 IP 주소 (약 250개 사용 가능)
    - 범위 예시: 192.168.0.0/24 = 192.168.0.0 ~ 192.168.0.255
- **/27 서브넷**: 32개 IP 주소 (약 29개 사용 가능)
    - 범위 예시: 192.168.0.0/27 = 192.168.0.0 ~ 192.168.0.31

### VPC 크기와 서브넷 수

- **192.168.0.0/24 VPC**:
    - /27로 분할 시 최대 8개 서브넷 생성 가능
    - 서브넷 예: 192.168.0.0/27, 192.168.0.32/27, 192.168.0.64/27 등
- **192.168.0.0/16 VPC**:
    - 총 65,536개 IP 주소 포함
    - /24 서브넷으로 분할 시 최대 256개 서브넷 생성 가능
    - /27 서브넷으로 분할 시 최대 2,048개 서브넷 생성 가능
    - 서브넷 예: 192.168.0.0/27, 192.168.0.32/27, ... 192.168.255.224/27

## VPC 내 통신

### 서브넷 간 통신

- 같은 VPC 내 다른 서브넷에 위치한 서버들은 기본적으로 서로 통신 가능합니다.
- 별도의 NAT, VPN 없이도 내부 통신이 가능합니다.
- 통신 제한이 필요한 경우 네트워크 ACL이나 보안 그룹으로 관리합니다.

### 퍼블릭/프라이빗 서브넷

- **퍼블릭 서브넷**: 인터넷 게이트웨이와 연결되어 인터넷과 직접 통신 가능
- **프라이빗 서브넷**: 인터넷과 직접 통신 불가, 내부 네트워크로만 접근 가능

## 비공인 IP 서버 접근 방법

비공인 IP(사설 IP)를 가진 서버에 외부에서 접속하는 방법:

### 1. VPN 연결 사용

- NCP의 IPsec VPN 또는 SSL VPN 서비스 활용
- VPC 내에 OpenVPN, WireGuard 등의 VPN 서버 구축 가능
- 개인 장치에서 VPN 클라이언트를 통해 비공인 IP 서버에 직접 접속

### 2. 배스천 호스트(Bastion Host) 활용

- 공인 IP를 가진 서버를 중계 서버로 활용
- SSH 터널링을 통해 비공인 IP 서버에 접근
- 예시: `ssh -i key.pem -J user@bastion-public-ip user@private-server-ip`

### 3. NCP 콘솔 서비스 활용

- NCP 콘솔에서 제공하는 서버 접속 기능 사용
- 별도의 공인 IP나 중계 서버 없이도 접속 가능

### 4. Cloud Connect/전용선 연결

- 온프레미스 환경과 NCP 환경을 전용선으로 연결
- 대규모 기업에 적합한 솔루션

## 로드 밸런싱 및 게이트웨이

### 로드 밸런서

- Application Load Balancer(ALB)는 HTTP(S) 및 웹소켓 통신 모두 지원
- 경로 기반 라우팅으로 URL 패턴에 따라 다른 서버로 요청 전달 가능
- 같은 역할을 하는 여러 서버에 트래픽 분산 처리

### NAT 게이트웨이

- 프라이빗 서브넷의 서버가 인터넷과 통신할 수 있게 해주는 서비스
- 내부→외부(아웃바운드) 통신을 위한 것
- 인바운드 통신(외부→내부)에는 적합하지 않음

### API 게이트웨이

- URL 경로 기반으로 여러 백엔드 서비스로 라우팅
- API 관리, 모니터링, 인증 등 추가 기능 제공
- 개별 API 경로마다 설정이 필요하여 세밀한 제어 가능